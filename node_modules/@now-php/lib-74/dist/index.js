"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const path_1 = __importDefault(require("path"));
const build_utils_1 = require("@now/build-utils");
async function getLibFiles() {
    // Lookup for PHP bins, modules and shared objects
    const files = {
        ...await build_utils_1.glob('php/**', { cwd: path_1.default.join(__dirname, '../native') }),
        ...await build_utils_1.glob('lib/**', { cwd: path_1.default.join(__dirname, '../native') }),
    };
    // Replace paths in php.ini file
    const phpini = await build_utils_1.FileBlob.fromStream({
        stream: files['php/php.ini'].toStream(),
    });
    phpini.data = phpini.data
        .toString()
        .replace(/\/opt\/now\/modules/g, '/var/task/php/modules');
    files['php/php.ini'] = phpini;
    return files;
}
exports.getLibFiles = getLibFiles;
